PATH := /opt/homebrew/bin:$(HOME)/go/bin:$(PATH)
SHELL := env PATH=$(PATH) /bin/bash

.PHONY: clean install

build/SushitrainCore.xcframework: src/*.go Makefile
	@go version
	go get golang.org/x/mobile/cmd/gomobile

	@# The 'kqueue' and 'noassets' flags fix issues when building synchting/notify and syncthing's autogenerated assets respectively
	gomobile bind -target ios -tags kqueue,noassets -o ./build/SushitrainCore.xcframework ./src

build: build/SushitrainCore.xcframework
	
install: build

clean:
	rm -rf build/*